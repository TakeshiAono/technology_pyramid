<h1><%= I18n.t('searches.page') %></h1>

<%= search_form_for @q, url: searches_path do |f| %>
  <%= f.label :title_cont, I18n.t('works.name') %>
  <%= f.search_field :title_cont %>
  <%= f.submit '検索' %>
<% end %>

<table class="table ">
  <thead>
    <tr>
      <th><%= I18n.t('works.display') %></th>
      <th><%= I18n.t('users.display') %></th>
      <th><%= I18n.t('favorites.button') %></th>
      <th><%= I18n.t('favorites.display') %></th>
    </tr>
  </thead>

  <tbody class = "search-result-table">
    <% if @works.present? %>
      <% @works.each do |work| %>
        <tr>
          <td><%= link_to "#{work.title}", technologies_path(work) %></td>
          <td>
            <%= work.user.name %>
          </td>
          <td>
            <% if current_user == work.user %>
              <span class = "favorite-button">-</span>
            <% else %>
              <% if current_user.favorites.find_by(favorite_id: work.user.id).present? %>
                <%= link_to image_tag("hart.jpg", class:"favorite-button"), search_path(work.user), method: :delete unless current_user == work.user %>
              <% else %>
                <%= link_to image_tag("black_hart.jpg", class:"favorite-button"), searches_path(work.user), method: :post unless current_user == work.user %>
              <% end %>
            <% end %>
          </td>
          </td>
          <td>
            <%= work.user.favorited.count %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>